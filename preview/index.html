<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XZX Icon Vue2 - å›¾æ ‡é¢„è§ˆ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      color: white;
    }

    .header h1 {
      font-size: 3rem;
      margin-bottom: 10px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    .stats {
      background: rgba(255,255,255,0.2);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
      color: white;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      text-align: center;
    }

    .stat-item h3 {
      font-size: 2rem;
      margin-bottom: 5px;
    }

    .controls {
      background: rgba(255,255,255,0.95);
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }

    .search-box {
      position: relative;
      margin-bottom: 20px;
    }

    .search-box input {
      width: 100%;
      padding: 15px 50px 15px 20px;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      font-size: 16px;
      transition: all 0.3s ease;
    }

    .search-box input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .search-icon {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #666;
    }

    .filters {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }

    .filter-tag {
      padding: 8px 16px;
      background: #f5f5f5;
      border: 2px solid transparent;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 14px;
    }

    .filter-tag:hover {
      background: #e1e5e9;
    }

    .filter-tag.active {
      background: #667eea;
      color: white;
    }

    .icons-grid {
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 20px;
    }

    .icon-item {
      text-align: center;
      padding: 20px;
      border: 2px solid #f5f5f5;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .icon-item:hover {
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .icon-item.copied {
      border-color: #52c41a;
      background: #f6ffed;
    }

    .icon-display {
      font-size: 32px;
      margin-bottom: 10px;
      color: #333;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .icon-name {
      font-size: 12px;
      color: #666;
      word-break: break-all;
      line-height: 1.3;
    }

    .copy-tooltip {
      position: absolute;
      top: -30px;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 12px;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      white-space: nowrap;
    }

    .copy-tooltip.show {
      opacity: 1;
    }

    .no-results {
      text-align: center;
      padding: 60px 20px;
      color: #999;
    }

    .no-results .icon {
      font-size: 64px;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    .loading {
      text-align: center;
      padding: 60px 20px;
      color: #666;
    }

    .loading .spinner {
      display: inline-block;
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .footer {
      text-align: center;
      margin-top: 40px;
      color: rgba(255,255,255,0.8);
    }

    .footer a {
      color: rgba(255,255,255,0.9);
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }

      .icons-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 15px;
        padding: 20px;
      }

      .icon-item {
        padding: 15px;
      }

      .icon-display {
        font-size: 24px;
        height: 30px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1>ğŸ¨ XZX Icon Vue2</h1>
      <p>ç²¾ç¾çš„ Vue2 å›¾æ ‡ç»„ä»¶åº“</p>
    </header>

    <div class="stats">
      <div class="stats-grid">
        <div class="stat-item">
          <h3 id="total-count">-</h3>
          <p>æ€»å›¾æ ‡æ•°</p>
        </div>
        <div class="stat-item">
          <h3 id="filtered-count">-</h3>
          <p>å½“å‰æ˜¾ç¤º</p>
        </div>
        <div class="stat-item">
          <h3>Vue2</h3>
          <p>å…¼å®¹ç‰ˆæœ¬</p>
        </div>
      </div>
    </div>

    <div class="controls">
      <div class="search-box">
        <input
          type="text"
          id="search-input"
          placeholder="ğŸ” æœç´¢å›¾æ ‡åç§°... (æŒ‰ / å¿«é€Ÿèšç„¦ï¼ŒESC æ¸…ç©º)"
          autocomplete="off"
        >
        <div class="search-icon">âŒ•</div>
      </div>

      <div class="filters">
        <span style="color: #666; margin-right: 10px;">å¿«é€Ÿç­›é€‰:</span>
        <div class="filter-tag active" data-filter="all">å…¨éƒ¨</div>
        <div class="filter-tag" data-filter="filled">å¡«å……ç±»</div>
        <div class="filter-tag" data-filter="one">å•è‰²ç±»</div>
        <div class="filter-tag" data-filter="arrow">ç®­å¤´ç±»</div>
        <div class="filter-tag" data-filter="file">æ–‡ä»¶ç±»</div>
        <div class="filter-tag" data-filter="edit">ç¼–è¾‘ç±»</div>
        <div class="filter-tag" data-filter="close">å…³é—­ç±»</div>
      </div>
    </div>

    <div id="icons-container">
      <div class="loading">
        <div class="spinner"></div>
        <p>æ­£åœ¨åŠ è½½å›¾æ ‡...</p>
      </div>
    </div>

    <footer class="footer">
      <p>
        åŸºäº <a href="https://www.npmjs.com/package/@xzx-design/icons-svg" target="_blank" rel="noopener">@xzx-design/icons-svg</a> æ„å»º
        | ç‚¹å‡»å›¾æ ‡å¤åˆ¶ Vue ä»£ç 
      </p>
    </footer>
  </div>

  <!-- Vue2 -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <!-- æœ¬åœ°å›¾æ ‡åº“ -->
  <script src="/lib/index.umd.js"></script>

  <script>
    // å…¨å±€å˜é‡å­˜å‚¨Vueå®ä¾‹
    let vueApp = null

    // å¤åˆ¶å›¾æ ‡ä»£ç åŠŸèƒ½
    function copyIconCode(iconName, element) {
      const code = `<xzx-icon name="${iconName}" size="24"></xzx-icon>`

      // åˆ›å»ºä¸´æ—¶å…ƒç´ å¤åˆ¶åˆ°å‰ªè´´æ¿
      const textarea = document.createElement('textarea')
      textarea.value = code
      document.body.appendChild(textarea)
      textarea.select()
      document.execCommand('copy')
      document.body.removeChild(textarea)

      // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
      element.classList.add('copied')
      const tooltip = element.querySelector('.copy-tooltip')
      tooltip.textContent = 'å·²å¤åˆ¶ï¼'
      tooltip.classList.add('show')

      setTimeout(() => {
        element.classList.remove('copied')
        tooltip.classList.remove('show')
        tooltip.textContent = 'ç‚¹å‡»å¤åˆ¶ä»£ç '
      }, 1500)

      // æ›´æ–°ç»Ÿè®¡
      if (vueApp) {
        vueApp.copyCount++
      }
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–Vueåº”ç”¨
    document.addEventListener('DOMContentLoaded', () => {
      console.log('ğŸš€ é¢„è§ˆé¡µé¢å¼€å§‹åˆå§‹åŒ–...')

      // ç®€åŒ–çš„ç»„ä»¶æ³¨å†Œé€»è¾‘
      if (window.XzxIconVue2) {
        // å°è¯•ä¸åŒçš„æ³¨å†Œæ–¹å¼ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰
        if (window.XzxIconVue2.default && typeof window.XzxIconVue2.default.install === 'function') {
          Vue.use(window.XzxIconVue2.default)
          console.log('âœ… ä½¿ç”¨ default.install æ³¨å†Œç»„ä»¶')
        } else if (typeof window.XzxIconVue2.install === 'function') {
          Vue.use(window.XzxIconVue2)
          console.log('âœ… ä½¿ç”¨ install æ³¨å†Œç»„ä»¶')
        } else if (window.XzxIconVue2.XzxIcon) {
          Vue.component('XzxIcon', window.XzxIconVue2.XzxIcon)
          console.log('âœ… æ‰‹åŠ¨æ³¨å†Œç»„ä»¶')
        } else if (window.XzxIconVue2.default && window.XzxIconVue2.default.XzxIcon) {
          Vue.component('XzxIcon', window.XzxIconVue2.default.XzxIcon)
          console.log('âœ… é€šè¿‡ default æ‰‹åŠ¨æ³¨å†Œç»„ä»¶')
        }
      } else {
        console.error('âŒ XzxIconVue2 å…¨å±€å˜é‡æœªæ‰¾åˆ°')
      }

      // Vue åº”ç”¨
      vueApp = new Vue({
        el: '.container',
        data: {
          allIcons: [],
          filteredIcons: [],
          searchQuery: '',
          activeFilter: 'all',
          loading: true,
          copyCount: 0
        },
        async mounted() {
          console.log('ğŸ¯ Vueåº”ç”¨å·²æŒ‚è½½')
          await this.loadIcons()
          this.setupEventListeners()

          // æ·»åŠ æ¸²æŸ“æ£€æŸ¥
          this.$nextTick(() => {
            setTimeout(() => {
              const iconElements = document.querySelectorAll('.icon-display xzx-icon')
              const svgElements = document.querySelectorAll('.icon-display svg')
              console.log(`ğŸ” å›¾æ ‡å…ƒç´ : ${iconElements.length}, SVGå…ƒç´ : ${svgElements.length}`)

              if (iconElements.length > 0 && svgElements.length === 0) {
                console.error('âŒ å›¾æ ‡ç»„ä»¶æœªæ­£ç¡®æ¸²æŸ“ä¸ºSVG')
              } else if (svgElements.length > 0) {
                console.log('âœ… å›¾æ ‡æ¸²æŸ“æˆåŠŸ')
              }
            }, 200)
          })
        },
        methods: {
          async loadIcons() {
            try {
              const response = await fetch('/api/icons')
              const data = await response.json()
              this.allIcons = data.icons || []
              this.filteredIcons = [...this.allIcons]

              document.getElementById('total-count').textContent = this.allIcons.length
              document.getElementById('filtered-count').textContent = this.filteredIcons.length

              this.renderIcons()
              this.loading = false
            } catch (error) {
              console.error('åŠ è½½å›¾æ ‡å¤±è´¥:', error)
              this.showError()
            }
          },

          setupEventListeners() {
            // æœç´¢åŠŸèƒ½
            const searchInput = document.getElementById('search-input')
            searchInput.addEventListener('input', (e) => {
              this.searchQuery = e.target.value.toLowerCase()
              this.filterIcons()
            })

            // ç­›é€‰æ ‡ç­¾
            document.querySelectorAll('.filter-tag').forEach(tag => {
              tag.addEventListener('click', (e) => {
                document.querySelectorAll('.filter-tag').forEach(t => t.classList.remove('active'))
                e.target.classList.add('active')
                this.activeFilter = e.target.dataset.filter
                this.filterIcons()
              })
            })

            // é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', (e) => {
              if (e.key === '/' && !e.ctrlKey && !e.metaKey) {
                e.preventDefault()
                searchInput.focus()
              }
              if (e.key === 'Escape') {
                searchInput.blur()
                searchInput.value = ''
                this.searchQuery = ''
                this.filterIcons()
              }
            })
          },

          filterIcons() {
            let filtered = [...this.allIcons]

            // æ–‡æœ¬æœç´¢
            if (this.searchQuery) {
              filtered = filtered.filter(icon =>
                icon.toLowerCase().includes(this.searchQuery)
              )
            }

            // åˆ†ç±»ç­›é€‰
            if (this.activeFilter !== 'all') {
              filtered = filtered.filter(icon => {
                switch (this.activeFilter) {
                  case 'filled':
                    return icon.includes('filled')
                  case 'one':
                    return icon.includes('one')
                  case 'arrow':
                    return ['left', 'right', 'up', 'down', 'arrow'].some(word => icon.includes(word))
                  case 'file':
                    return icon.includes('file')
                  case 'edit':
                    return ['edit', 'write', 'pen', 'pencil'].some(word => icon.includes(word))
                  case 'close':
                    return ['close', 'delete', 'remove', 'minus'].some(word => icon.includes(word))
                  default:
                    return true
                }
              })
            }

            this.filteredIcons = filtered
            document.getElementById('filtered-count').textContent = filtered.length
            this.renderIcons()
          },

          renderIcons() {
            const container = document.getElementById('icons-container')

            if (this.filteredIcons.length === 0) {
              container.innerHTML = `
                <div class="no-results">
                  <div class="icon">ğŸ”</div>
                  <h3>æœªæ‰¾åˆ°åŒ¹é…çš„å›¾æ ‡</h3>
                  <p>å°è¯•ä½¿ç”¨å…¶ä»–å…³é”®è¯æœç´¢ï¼Œæˆ–æŒ‰ Esc é‡ç½®æœç´¢</p>
                </div>
              `
              return
            }

            const iconsHTML = this.filteredIcons.map(iconName => `
              <div class="icon-item" data-icon="${iconName}" onclick="copyIconCode('${iconName}', this)">
                <div class="icon-display">
                  <xzx-icon name="${iconName}" size="32"></xzx-icon>
                </div>
                <div class="icon-name">${iconName}</div>
                <div class="copy-tooltip">ç‚¹å‡»å¤åˆ¶ä»£ç </div>
              </div>
            `).join('')

            container.innerHTML = `<div class="icons-grid">${iconsHTML}</div>`

            // ç­‰å¾…DOMæ›´æ–°åé‡æ–°ç¼–è¯‘Vueç»„ä»¶
            this.$nextTick(() => {
              // è·å–æ–°æ’å…¥çš„å›¾æ ‡å…ƒç´ å¹¶æ‰‹åŠ¨ç¼–è¯‘
              const newIconElements = container.querySelectorAll('xzx-icon')
              console.log(`ğŸ”„ æ­£åœ¨ç¼–è¯‘ ${newIconElements.length} ä¸ªå›¾æ ‡ç»„ä»¶`)

              // ä½¿ç”¨Vueçš„ç¼–è¯‘æ–¹æ³•é‡æ–°ç¼–è¯‘æ–°æ’å…¥çš„å…ƒç´ 
              if (newIconElements.length > 0) {
                newIconElements.forEach(el => {
                  if (!el.__vue__) {
                    // æ‰‹åŠ¨åˆ›å»ºVueç»„ä»¶å®ä¾‹
                    new Vue({
                      el: el,
                      components: {
                        'xzx-icon': Vue.options.components.XzxIcon
                      }
                    })
                  }
                })
              }
            })
          },

          showError() {
            document.getElementById('icons-container').innerHTML = `
              <div class="no-results">
                <div class="icon">âŒ</div>
                <h3>åŠ è½½å¤±è´¥</h3>
                <p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•</p>
              </div>
            `
            this.loading = false
          }
        }
      })
    })
  </script>
</body>
</html>
