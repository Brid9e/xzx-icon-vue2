<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å›¾æ ‡ç»„ä»¶è°ƒè¯•</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .debug-section {
      background: white;
      padding: 20px;
      margin: 20px 0;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .test-icon {
      display: inline-block;
      margin: 10px;
      padding: 10px;
      border: 2px solid #ddd;
      border-radius: 4px;
      text-align: center;
    }
    .success { border-color: #52c41a; background: #f6ffed; }
    .error { border-color: #ff4d4f; background: #fff1f0; }
  </style>
</head>
<body>
  <h1>ğŸ”§ å›¾æ ‡ç»„ä»¶è°ƒè¯•é¡µé¢</h1>

  <div class="debug-section">
    <h2>ğŸ“Š å…¨å±€å˜é‡æ£€æŸ¥</h2>
    <div id="global-check">æ£€æŸ¥ä¸­...</div>
  </div>

  <div class="debug-section">
    <h2>ğŸ§ª ç»„ä»¶æµ‹è¯•</h2>
    <div id="app">
      <div class="test-icon" id="test1">
        <xzx-icon name="search" size="32"></xzx-icon>
        <br>æœç´¢å›¾æ ‡
      </div>
      <div class="test-icon" id="test2">
        <xzx-icon name="camera" size="32" color="red"></xzx-icon>
        <br>ç›¸æœºå›¾æ ‡
      </div>
      <div class="test-icon" id="test3">
        <xzx-icon name="like" size="32" color="blue"></xzx-icon>
        <br>å–œæ¬¢å›¾æ ‡
      </div>
    </div>
  </div>

  <div class="debug-section">
    <h2>ğŸ“ æ—¥å¿—è¾“å‡º</h2>
    <div id="logs" style="font-family: monospace; background: #f0f0f0; padding: 10px; border-radius: 4px; max-height: 300px; overflow-y: auto;">
    </div>
  </div>

  <!-- Vue2 -->
  <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  <!-- æœ¬åœ°å›¾æ ‡åº“ -->
  <script src="./lib/index.umd.js"></script>

  <script>
    // æ—¥å¿—å‡½æ•°
    function log(message, type = 'info') {
      const timestamp = new Date().toLocaleTimeString()
      const logElement = document.getElementById('logs')
      const color = type === 'error' ? 'red' : type === 'success' ? 'green' : 'black'
      logElement.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`
      logElement.scrollTop = logElement.scrollHeight
      console.log(message)
    }

    document.addEventListener('DOMContentLoaded', () => {
      log('ğŸš€ å¼€å§‹è°ƒè¯•...')

      // 1. æ£€æŸ¥å…¨å±€å˜é‡
      const globalCheck = document.getElementById('global-check')

      log('ğŸ” æ£€æŸ¥ window.XzxIconVue2...')
      if (window.XzxIconVue2) {
        log('âœ… window.XzxIconVue2 å­˜åœ¨', 'success')
        log(`ğŸ“‹ ç±»å‹: ${typeof window.XzxIconVue2}`)
        log(`ğŸ“‹ é”®: ${Object.keys(window.XzxIconVue2).join(', ')}`)

        if (window.XzxIconVue2.default) {
          log(`ğŸ“‹ default é”®: ${Object.keys(window.XzxIconVue2.default).join(', ')}`)
        }

        globalCheck.innerHTML = `
          <div style="color: green;">âœ… XzxIconVue2 å·²åŠ è½½</div>
          <div>ç±»å‹: ${typeof window.XzxIconVue2}</div>
          <div>é”®: ${Object.keys(window.XzxIconVue2).join(', ')}</div>
          ${window.XzxIconVue2.default ? `<div>defaulté”®: ${Object.keys(window.XzxIconVue2.default).join(', ')}</div>` : ''}
        `
      } else {
        log('âŒ window.XzxIconVue2 ä¸å­˜åœ¨', 'error')
        globalCheck.innerHTML = '<div style="color: red;">âŒ XzxIconVue2 æœªåŠ è½½</div>'
      }

      // 2. å°è¯•æ³¨å†Œç»„ä»¶
      let registered = false

      if (window.XzxIconVue2) {
        try {
          if (window.XzxIconVue2.default && typeof window.XzxIconVue2.default.install === 'function') {
            Vue.use(window.XzxIconVue2.default)
            log('âœ… ä½¿ç”¨ XzxIconVue2.default.install() æ³¨å†Œ', 'success')
            registered = true
          } else if (typeof window.XzxIconVue2.install === 'function') {
            Vue.use(window.XzxIconVue2)
            log('âœ… ä½¿ç”¨ XzxIconVue2.install() æ³¨å†Œ', 'success')
            registered = true
          } else if (window.XzxIconVue2.XzxIcon) {
            Vue.component('XzxIcon', window.XzxIconVue2.XzxIcon)
            log('âœ… æ‰‹åŠ¨æ³¨å†Œ XzxIcon ç»„ä»¶', 'success')
            registered = true
          } else if (window.XzxIconVue2.default && window.XzxIconVue2.default.XzxIcon) {
            Vue.component('XzxIcon', window.XzxIconVue2.default.XzxIcon)
            log('âœ… æ‰‹åŠ¨æ³¨å†Œ XzxIcon ç»„ä»¶ (é€šè¿‡ default)', 'success')
            registered = true
          } else {
            log('âŒ æ— æ³•æ‰¾åˆ°æœ‰æ•ˆçš„æ³¨å†Œæ–¹æ³•', 'error')
          }
        } catch (error) {
          log(`âŒ æ³¨å†Œç»„ä»¶æ—¶å‡ºé”™: ${error.message}`, 'error')
        }
      }

      // 3. åˆ›å»ºVueå®ä¾‹
      const app = new Vue({
        el: '#app',
        mounted() {
          log('ğŸ¯ Vueåº”ç”¨å·²æŒ‚è½½')

          // æ£€æµ‹ç»„ä»¶æ˜¯å¦æˆåŠŸæ¸²æŸ“
          setTimeout(() => {
            const testElements = document.querySelectorAll('.test-icon')
            testElements.forEach((el, index) => {
              const svg = el.querySelector('svg')
              if (svg) {
                el.classList.add('success')
                log(`âœ… æµ‹è¯• ${index + 1} æˆåŠŸæ¸²æŸ“`, 'success')
              } else {
                el.classList.add('error')
                log(`âŒ æµ‹è¯• ${index + 1} æ¸²æŸ“å¤±è´¥`, 'error')
              }
            })
          }, 500)
        }
      })

      log('ğŸ è°ƒè¯•å®Œæˆ')
    })
  </script>
</body>
</html>
